<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Financial Tracker 2025 - Finners Daily</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.29/jspdf.plugin.autotable.min.js"></script>

    <style>
        /* --- CSS VARIABLES (TEMA DISESUAIKAN DENGAN LOGO) --- */
        :root {
            --primary: #FF3D2E;      /* Merah cerah dari Logo */
            --secondary: #2D2424;    /* Cokelat gelap hangat */
            --bg-dark: #1A1515;      /* Background utama hampir hitam dengan tint merah */
            --accent-green: #00E096; /* Warna Pemasukan */
            --accent-red: #FF3D2E;   /* Warna Pengeluaran sama dengan Logo */
            --text-main: #FDF5E6;    /* Krem/Off-white dari teks Logo */
            --text-muted: #A09090;   /* Abu-abu hangat */
            --border-color: #453838; /* Border kecokelatan halus */
            --hover-color: #FF574A;  
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Poppins', sans-serif; }
        
        body { 
            background-color: var(--bg-dark); 
            color: var(--text-main);
            height: 100vh;
            overflow: hidden; 
            display: flex;
        }

        /* --- SIDEBAR --- */
        .sidebar {
            width: 250px;
            background-color: var(--secondary);
            display: flex;
            flex-direction: column;
            padding: 20px;
            border-right: 1px solid var(--border-color);
            transition: all 0.3s;
            z-index: 100;
        }

        /* Modifikasi Brand: Logo di atas, Teks di bawah */
        .brand {
            display: flex;
            flex-direction: column; 
            align-items: center;    
            justify-content: center; 
            gap: 10px;              
            margin-bottom: 40px;
            text-align: center;     
        }

        .brand img {
            width: 100px;           /* Ukuran diperbesar agar proporsional di tengah */
            height: auto;
            border-radius: 8px;
        }

        .brand h2 { 
            font-size: 1.2rem; 
            font-weight: 700; 
            color: var(--text-main); 
        }

        .menu-list { list-style: none; }
        .menu-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 12px 15px;
            margin-bottom: 10px;
            color: var(--text-muted);
            border-radius: 12px;
            cursor: pointer;
            transition: 0.3s;
            text-decoration: none;
        }
        .menu-item:hover, .menu-item.active {
            background-color: var(--primary);
            color: white;
            box-shadow: 0 4px 15px rgba(255, 61, 46, 0.3);
        }
        .menu-item i { width: 20px; text-align: center; }

        .logout-btn {
            margin-top: auto;
            color: var(--accent-red);
            border: 1px solid var(--border-color);
        }
        .logout-btn:hover { background: rgba(255, 61, 46, 0.1); color: var(--accent-red); box-shadow: none; }

        /* --- MAIN CONTENT AREA --- */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            position: relative;
        }

        /* --- TOP HEADER --- */
        header {
            height: 80px;
            padding: 0 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: transparent; 
            border-bottom: 1px solid rgba(255,255,255,0.05);
        }

        .header-title h1 { font-size: 1.5rem; font-weight: 600; }
        .header-title p { font-size: 0.85rem; color: var(--text-muted); }

        .header-actions { display: flex; align-items: center; gap: 20px; }
        
        .filter-group {
            display: flex;
            gap: 10px;
            background: var(--secondary);
            padding: 5px;
            border-radius: 10px;
            border: 1px solid var(--border-color);
        }

        .custom-selector {
            background: transparent;
            border: none;
            color: var(--text-main);
            padding: 5px 10px;
            outline: none;
            cursor: pointer;
            font-size: 0.9rem;
        }
        
        .custom-selector option {
            background: var(--secondary);
            color: var(--text-main);
        }

        input[type="date"].custom-selector {
            border-left: 1px solid var(--border-color);
            padding-left: 15px;
            color: var(--text-main);
            font-family: 'Poppins', sans-serif;
        }
        input[type="date"]::-webkit-calendar-picker-indicator {
            filter: invert(1);
            cursor: pointer;
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 10px;
            background: var(--secondary);
            padding: 5px 15px 5px 5px;
            border-radius: 50px;
            border: 1px solid var(--border-color);
        }
        .avatar {
            width: 35px; height: 35px;
            background: var(--primary);
            border-radius: 50%;
            display: flex; 
            align-items: center; 
            justify-content: center;
            font-weight: bold;
            color: white;
        }

        /* --- VIEWS --- */
        .view-section {
            padding: 20px 30px;
            overflow-y: auto;
            flex: 1;
            display: none; 
            animation: fadeIn 0.3s ease-in-out;
        }
        .view-section.active-view {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }
        .stat-card {
            background: var(--secondary);
            padding: 20px;
            border-radius: 20px;
            display: flex;
            align-items: center;
            gap: 20px;
            transition: transform 0.2s;
            border: 1px solid var(--border-color);
        }
        .stat-card:hover { transform: translateY(-5px); }
        
        .icon-box {
            width: 50px; height: 50px;
            border-radius: 15px;
            display: flex; align-items: center; justify-content: center;
            font-size: 1.5rem;
        }
        .ib-primary { background: rgba(255, 61, 46, 0.2); color: var(--primary); }
        .ib-green { background: rgba(0, 224, 150, 0.2); color: var(--accent-green); }

        .stat-info h3 { font-size: 0.9rem; color: var(--text-muted); font-weight: 400; margin-bottom: 5px; }
        .stat-info p { font-size: 1.4rem; font-weight: 600; }

        .content-layout {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .panel {
            background: var(--secondary);
            border-radius: 20px;
            padding: 25px;
            border: 1px solid var(--border-color);
        }
        .panel-header {
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-color);
        }

        .transaction-list { max-height: 400px; overflow-y: auto; }
        .trx-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid rgba(255,255,255,0.05);
        }
        .cat-icon {
            width: 40px; height: 40px;
            background: #3d3434;
            border-radius: 10px;
            display: flex; align-items: center; justify-content: center;
            color: var(--text-muted);
        }
        
        .text-in { color: var(--accent-green); }
        .text-out { color: var(--accent-red); }

        .form-control {
            width: 100%;
            background: var(--bg-dark);
            border: 1px solid var(--border-color);
            padding: 12px;
            border-radius: 10px;
            color: var(--text-main);
            outline: none;
            margin-top: 5px;
        }
        
        .btn-primary {
            width: 100%;
            padding: 12px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: 0.3s;
        }
        .btn-primary:hover { opacity: 0.9; transform: translateY(-2px); }

        .btn-export {
            background: var(--secondary);
            border: 1px solid var(--border-color);
            color: var(--text-main);
            padding: 8px 15px;
            border-radius: 8px;
            cursor: pointer;
            transition: 0.3s;
        }
        .btn-export:hover { background: var(--primary); border-color: var(--primary); }

        .data-table { width: 100%; border-collapse: collapse; color: var(--text-muted); }
        .data-table th, .data-table td { text-align: left; padding: 15px; border-bottom: 1px solid var(--border-color); }
        .data-table th { color: var(--text-main); }

        /* ATM CARD THEME */
        .atm-card {
            width: 350px; height: 210px; border-radius: 20px; padding: 25px;
            color: white; position: relative; display: flex; flex-direction: column; justify-content: space-between;
        }
        .card-gradient-1 { background: linear-gradient(135deg, #FF3D2E 0%, #8B1A1A 100%); }

        .modal {
            display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; 
            background-color: rgba(0,0,0,0.8); align-items: center; justify-content: center;
        }
        .modal-content { background-color: var(--secondary); padding: 30px; border-radius: 20px; width: 400px; border: 1px solid var(--border-color); }
    </style>
</head>
<body onload="initApp()">

    <nav class="sidebar">
        <div class="brand">
            <img src="finners-daily-logo.png" alt="Logo">
            <h2>FinnersDaily</h2>
        </div>
        <ul class="menu-list">
            <li class="menu-item active" onclick="switchMenu(this, 'dashboard')">
                <i class="fa-solid fa-house"></i>
                <span>Dashboard</span>
            </li>
            <li class="menu-item" onclick="switchMenu(this, 'transaksi')">
                <i class="fa-solid fa-list"></i>
                <span>Transaksi</span>
            </li>
            <li class="menu-item" onclick="switchMenu(this, 'laporan')">
                <i class="fa-solid fa-chart-pie"></i>
                <span>Laporan</span>
            </li>
            <li class="menu-item" onclick="switchMenu(this, 'wallet')">
                <i class="fa-solid fa-wallet"></i>
                <span>Wallet</span>
            </li>
            <li class="menu-item logout-btn" onclick="resetData()">
                <i class="fa-solid fa-trash"></i>
                <span>Reset Data</span>
            </li>
        </ul>
    </nav>

    <main class="main-content">
        <header>
            <div class="header-title">
                <h1 id="pageTitle">Overview</h1>
                <p>Halo, Selamat datang kembali di Finners Daily!</p>
            </div>
            <div class="header-actions">
                <div class="filter-group">
                    <select id="viewMode" class="custom-selector" onchange="refreshCurrentView()">
                        <option value="monthly">Bulanan</option>
                        <option value="daily">Harian</option>
                    </select>
                    <input type="date" id="overviewDate" class="custom-selector" onchange="refreshCurrentView()">
                </div>
                <div class="user-profile">
                    <div class="avatar">U</div>
                    <span>Kelompok 4</span>
                </div>
            </div>
        </header>

        <div id="dashboard-view" class="view-section active-view">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="icon-box ib-primary"><i class="fa-solid fa-wallet"></i></div>
                    <div class="stat-info">
                        <h3>Sisa Saldo</h3>
                        <p id="totalBalance" style="color:var(--primary)">Rp 0</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="icon-box ib-green"><i class="fa-solid fa-arrow-trend-up"></i></div>
                    <div class="stat-info">
                        <h3 id="labelIncome">Pemasukan</h3>
                        <p id="totalIncome" style="color:var(--accent-green)">Rp 0</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="icon-box ib-primary"><i class="fa-solid fa-arrow-trend-down"></i></div>
                    <div class="stat-info">
                        <h3 id="labelExpense">Pengeluaran</h3>
                        <p id="totalExpense" style="color:var(--accent-red)">Rp 0</p>
                    </div>
                </div>
            </div>

            <div class="content-layout">
                <div class="panel">
                    <div class="panel-header"><span class="panel-title">Riwayat Terkini</span></div>
                    <ul class="transaction-list" id="trxList"></ul>
                </div>
                <div style="display: flex; flex-direction: column; gap: 20px;">
                    <div class="panel">
                        <div class="panel-header"><span class="panel-title">Tambah Transaksi</span></div>
                        <form onsubmit="addTransaction(event)">
                            <div style="margin-bottom:10px;">
                                <label style="font-size:0.8rem;">Tanggal</label>
                                <input type="date" id="tDate" class="form-control" required>
                            </div>
                            <div style="margin-bottom:10px;">
                                <label style="font-size:0.8rem;">Keterangan</label>
                                <input type="text" id="tName" class="form-control" placeholder="Makan siang" required>
                            </div>
                            <div style="margin-bottom:10px;">
                                <label style="font-size:0.8rem;">Nominal (Rp)</label>
                                <input type="number" id="tAmount" class="form-control" placeholder="0" required>
                            </div>
                            <div style="margin-bottom:10px;">
                                <label style="font-size:0.8rem;">Wallet</label>
                                <select id="tWallet" class="form-control" required></select>
                            </div>
                            <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px; margin-bottom:15px;">
                                <select id="tType" class="form-control" onchange="updateCategoryOptions()">
                                    <option value="expense">Pengeluaran</option>
                                    <option value="income">Pemasukan</option>
                                </select>
                                <select id="tCategory" class="form-control"></select>
                            </div>
                            <button type="submit" class="btn-primary">Simpan Data</button>
                        </form>
                    </div>
                    <div class="panel">
                        <div class="panel-header"><span class="panel-title">Analisis</span></div>
                        <div style="height: 180px;"><canvas id="financeChart"></canvas></div>
                    </div>
                </div>
            </div>
        </div>

        <div id="transaksi-view" class="view-section">
            <div class="panel">
                <div class="panel-header">
                    <span class="panel-title">Data Transaksi</span>
                    <button class="btn-export" onclick="openExportModal()"><i class="fa-solid fa-file-pdf"></i> Unduh PDF</button>
                </div>
                <table class="data-table">
                    <thead>
                        <tr><th>Tanggal</th><th>Keterangan</th><th>Dompet</th><th>Kategori</th><th>Tipe</th><th>Nominal</th><th>Aksi</th></tr>
                    </thead>
                    <tbody id="fullTrxTable"></tbody>
                </table>
            </div>
        </div>

        <div id="laporan-view" class="view-section">
             <div class="content-layout">
                <div class="panel">
                    <div class="panel-header"><span class="panel-title">Pemasukan vs Pengeluaran</span></div>
                    <div style="height: 300px;"><canvas id="reportChart"></canvas></div>
                </div>
                <div class="panel">
                    <div class="panel-header"><span class="panel-title">Ringkasan Periode</span></div>
                    <ul style="list-style: none;">
                        <li style="display:flex; justify-content:space-between; padding:15px 0; border-bottom:1px solid var(--border-color);">
                            <span>Total Pemasukan</span><span id="rptIncome" class="text-in">Rp 0</span>
                        </li>
                        <li style="display:flex; justify-content:space-between; padding:15px 0; border-bottom:1px solid var(--border-color);">
                            <span>Total Pengeluaran</span><span id="rptExpense" class="text-out">Rp 0</span>
                        </li>
                        <li style="display:flex; justify-content:space-between; padding:15px 0;">
                            <span>Sisa</span><span id="rptBalance" style="font-weight:bold;">Rp 0</span>
                        </li>
                    </ul>
                </div>
             </div>
        </div>

        <div id="wallet-view" class="view-section">
            <div class="wallet-grid" id="walletContainer" style="display:flex; gap:20px; flex-wrap:wrap;"></div>
        </div>

        <div id="exportModal" class="modal">
            <div class="modal-content">
                <span style="float:right; cursor:pointer;" onclick="closeExportModal()">&times;</span>
                <h3>Ekspor PDF</h3>
                <div style="margin:15px 0;">
                    <label>Dari</label><input type="date" id="exportStartDate" class="form-control">
                    <label>Sampai</label><input type="date" id="exportEndDate" class="form-control">
                </div>
                <button onclick="executePDFExport()" class="btn-primary">Unduh Sekarang</button>
            </div>
        </div>

        <footer style="text-align: center; color: var(--text-muted); font-size: 0.8rem; padding: 20px;">
            &copy; 2025 Finners Daily Dashboard. Built by <strong>Kelompok 4 KWU UNS</strong>.
        </footer>
    </main>

    <script>
        const incomeCats = ['Gaji', 'Bonus', 'Hasil Usaha', 'Investasi', 'Lainnya'];
        const expenseCats = ['Makanan', 'Transport', 'Belanja', 'Tagihan', 'Cicilan', 'Lainnya'];
        const categoryIcons = { 'Gaji': 'fa-money-bill-wave', 'Bonus': 'fa-gift', 'Makanan': 'fa-utensils', 'Transport': 'fa-bus', 'Belanja': 'fa-cart-shopping' };
        let transactions = [], wallets = [], dashboardChart, reportChart, activeView = 'dashboard';

        function initApp() {
            transactions = JSON.parse(localStorage.getItem('fin_tracker_2025_v2')) || [];
            wallets = JSON.parse(localStorage.getItem('fin_tracker_wallets_v2')) || [];
            if(wallets.length === 0) { wallets.push({ id: Date.now(), name: "Main Wallet", type: "Cash", initialBalance: 0, style: 1 }); saveWallets(); }
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('tDate').value = today;
            document.getElementById('overviewDate').value = today;
            updateCategoryOptions(); updateWalletOptions(); initCharts(); renderDashboard();
        }

        function switchMenu(el, name) {
            document.querySelectorAll('.menu-item').forEach(i => i.classList.remove('active'));
            el.classList.add('active');
            document.querySelectorAll('.view-section').forEach(v => { v.classList.remove('active-view'); v.style.display = 'none'; });
            document.getElementById(name + '-view').style.display = 'block';
            document.getElementById(name + '-view').classList.add('active-view');
            activeView = name; document.getElementById('pageTitle').innerText = name.toUpperCase(); refreshCurrentView();
        }

        function refreshCurrentView() {
            if(activeView === 'dashboard') renderDashboard();
            if(activeView === 'transaksi') renderTransactionTable();
            if(activeView === 'laporan') renderReportView();
            if(activeView === 'wallet') renderWalletView();
        }

        function getFilteredTransactions() {
            const mode = document.getElementById('viewMode').value;
            const dateVal = document.getElementById('overviewDate').value;
            if(!dateVal) return [];
            const d = new Date(dateVal);
            return transactions.filter(t => {
                const td = new Date(t.date);
                return mode === 'daily' ? t.date === dateVal : td.getMonth() === d.getMonth() && td.getFullYear() === d.getFullYear();
            });
        }

        function renderDashboard() {
            const data = getFilteredTransactions();
            let tin = 0, tout = 0, chartData = {};
            const list = document.getElementById('trxList'); list.innerHTML = '';
            data.sort((a,b) => new Date(b.date) - new Date(a.date)).forEach(t => {
                if(t.type === 'income') tin += t.amount; else tout += t.amount;
                chartData[t.category] = (chartData[t.category] || 0) + t.amount;
                const li = document.createElement('li'); li.className = 'trx-item';
                li.innerHTML = `<div style="display:flex; gap:10px;"><div class="cat-icon"><i class="fa-solid ${categoryIcons[t.category] || 'fa-tag'}"></i></div>
                                <div><h4>${t.name}</h4><small>${t.category}</small></div></div>
                                <div class="${t.type === 'income' ? 'text-in' : 'text-out'}">${t.type === 'income' ? '+' : '-'} ${formatRupiah(t.amount)}</div>`;
                list.appendChild(li);
            });
            document.getElementById('totalIncome').innerText = formatRupiah(tin);
            document.getElementById('totalExpense').innerText = formatRupiah(tout);
            let bal = 0; wallets.forEach(w => { let b = w.initialBalance; transactions.forEach(t => { if(t.walletId == w.id) b += (t.type === 'income' ? t.amount : -t.amount); }); bal += b; });
            document.getElementById('totalBalance').innerText = formatRupiah(bal);
            updateDashboardChart(chartData);
        }

        function formatRupiah(n) { return new Intl.NumberFormat('id-ID', { style: 'currency', currency: 'IDR', minimumFractionDigits: 0 }).format(n); }
        function saveWallets() { localStorage.setItem('fin_tracker_wallets_v2', JSON.stringify(wallets)); }
        function saveData() { localStorage.setItem('fin_tracker_2025_v2', JSON.stringify(transactions)); }
        function updateCategoryOptions() { const type = document.getElementById('tType').value; const sel = document.getElementById('tCategory'); sel.innerHTML = ''; (type === 'income' ? incomeCats : expenseCats).forEach(c => { let o = document.createElement('option'); o.value = c; o.innerText = c; sel.appendChild(o); }); }
        function updateWalletOptions() { const sel = document.getElementById('tWallet'); sel.innerHTML = ''; wallets.forEach(w => { let o = document.createElement('option'); o.value = w.id; o.innerText = w.name; sel.appendChild(o); }); }
        function addTransaction(e) { e.preventDefault(); transactions.push({ id: Date.now(), date: document.getElementById('tDate').value, name: document.getElementById('tName').value, amount: parseFloat(document.getElementById('tAmount').value), type: document.getElementById('tType').value, category: document.getElementById('tCategory').value, walletId: document.getElementById('tWallet').value }); saveData(); refreshCurrentView(); }
        function resetData() { if(confirm('Hapus semua?')) { localStorage.clear(); location.reload(); } }
        function openExportModal() { document.getElementById('exportModal').style.display = 'flex'; }
        function closeExportModal() { document.getElementById('exportModal').style.display = 'none'; }
        
        function initCharts() {
            dashboardChart = new Chart(document.getElementById('financeChart'), { type: 'doughnut', data: { labels: [], datasets: [{ data: [], backgroundColor: ['#FF3D2E', '#00E096', '#FFB84D'] }] }, options: { plugins: { legend: { display: false } } } });
            reportChart = new Chart(document.getElementById('reportChart'), { type: 'bar', data: { labels: ['Masuk', 'Keluar'], datasets: [{ data: [0, 0], backgroundColor: ['#00E096', '#FF3D2E'] }] }, options: { plugins: { legend: { display: false } } } });
        }
        function updateDashboardChart(d) { dashboardChart.data.labels = Object.keys(d); dashboardChart.data.datasets[0].data = Object.values(d); dashboardChart.update(); }
        
        function renderTransactionTable() {
            const tbody = document.getElementById('fullTrxTable'); tbody.innerHTML = '';
            getFilteredTransactions().forEach(t => {
                const tr = document.createElement('tr');
                tr.innerHTML = `<td>${t.date}</td><td>${t.name}</td><td>${wallets.find(w=>w.id==t.walletId)?.name || '-'}</td><td>${t.category}</td><td>${t.type}</td><td class="${t.type==='income'?'text-in':'text-out'}">${formatRupiah(t.amount)}</td><td><button onclick="delTrx(${t.id})">x</button></td>`;
                tbody.appendChild(tr);
            });
        }
        function delTrx(id) { transactions = transactions.filter(t => t.id !== id); saveData(); refreshCurrentView(); }
        function renderWalletView() {
            const cont = document.getElementById('walletContainer'); cont.innerHTML = '';
            wallets.forEach(w => {
                const div = document.createElement('div'); div.className = 'atm-card card-gradient-1';
                div.innerHTML = `<div>${w.type}</div><div style="font-size:1.5rem;">${w.name}</div><div>${formatRupiah(w.initialBalance)}</div>`;
                cont.appendChild(div);
            });
        }
    </script>
</body>
</html>